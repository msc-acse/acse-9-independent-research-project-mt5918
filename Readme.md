# Independent Research Project

- Author: Michael Trapp
- CID: 01627245
- Title: Elementary Implementation of VTK files in C

# Architecture for this Repository

This repository contains three separate folders. The first folder "5cf633a9f7f8694a2b43950a" (overleaf key) contains the documentation. The second folder, "setup2d", contains data and original program files to produce FEMDEM simulations. The third folder, "Y2D", contains modified code and program files which produces VTK output files.

Travis is configured in file .travis.yml.

# Folder "setup2d"

## System requirements and Installation

Tests performed using the original code produced unrealistic simulations. Therefore, the system requirements are not clear. The following system requirements are given with the best intention of the author, but may not be final.

- Operating System: Optimally, Linux Ubuntu 14.04 LTS. For newer versions, errors are likely to occur. 
- Optional: A remote server which supports VTK 5.8.0.

- Software:
>- Visualization Toolkit VTK version 5.8.0. Newer versions fail. Version 5.8.0 cannot be downloaded from https://vtk.org/download/ . 
>- Paraview version 5.4.1. Paraview version 5.6.1 was tested as well. Other versions may work as well. https://www.paraview.org/download/
>- The personal pre and post processor GiD version 10.0.9 https://www.gidhome.com/download/ . Newer versions are incompatible, as they do not support access to the B2D problem set.

Tests were perfomed on a local Windows 10 operating system using Windows subsystem for Linux Ubuntu 18.04 LTS due to lack of alternatives. Resorting to remote Linux Ubuntu 14.04 LTS university server ese-pollux.ese.ic.ac.uk introduced extreme performance issues. For testing and small calculations, access to a remote server like the High Performance Computing HPC system at Imperial College https://www.imperial.ac.uk/computational-methods/hpc/ is in principal optional. It is advantageous primarily due to the module support for VTK version 5.8.0. Small test codes should ideally be able to be run locally instead if the dependencies were available to maximize the rate of code development.

## Usage 

1. Generate a y input file using GiD. 

GiD is extremely unreliable, and program code for GiD is inaccessible. Therefore, an attempt was made to replace GiD using Gmesh http://gmsh.info/ . Due to problems with the Gmesh API for C++ and the complexity of the data, the code is unfinished. For now, GiD must be used to create the y input files.

Starting GiD invokes a password window. The password is an IP address. Inquiries pertaining to this IP address should be directed towards the AMCG group at Imperial College. Entering a false address or ignoring this window appears to have no effect.

The GiD documentation is extremely poor. Generate a y file requires the following tasks, details can be found in the author's documentation:

- Setting the problem type to 'B2D'. If the problem type does not exist, either the GiD version is wrong or there is another problem.
- Creating a geometries via points, lines and surfaces (the case of creating 3D volumes is not considered here).
- Generating a mesh from the geometry.
- Specifying problem data. 
- Specifying the materials.
- Specifying initial conditions.
- Generating the y file. This is achieved via clicking "calculate" in the calculate menu.

To the knowledge of the author, any command line options whatsoever are not available for GiD. Within the program, a command line exists to specify numerics such as coordinates. The commandline is linked with the UI, which makes any automation impossible. Saving the GiD project creates a folder with several files. Once the y file is generated, any GiD files from this folder other than the y file are no longer needed.

Even when using Linux 14.04 operating system, tests files generated by GiD always resulted in errors when the code was compiled. Therefore, y files were generated only on specific machines which had been traditionally used to generate the y output files.

Compatibility issues between GiD and the operating system may have generated an invalid y file. This may be one potential reason why the Travis tests are failing in a clean environment.

2. Configure the following items in the user config file "config.txt":

- The test file name, which is the y-input file generated by GiD. 
- The bash path of the SSH Login for Imperial College HPC High Performance Computing System
- The HPC project directory, where the files are stored
- HPC qsubdir, with the qsub and qstat commands 
- A flag to run y2d code locally instead on hpc (this requires vtk 5.8.0)
- The bash path to paraview

After configuration, one or more bash scripts (depending on whether HPC is used) are ready to be executed to generate the output files.

3. Run the following bash script(s):

- test.sh runs programs 

>Yf
>m2vtu and 
>m2vtu_crack 
    
subsequently, using the GiD-generated input y file as a command argument

- script.sh is a submittable HPC script in case the HPC system is used.
- qstat.sh to check whether the HPC job has finished in case the HPC system was used.
- getresults.sh fetches the results from the HPC server in case the HPC system was used.

All scripts can be run in a Linux shell via the command:

>bash myscript.sh

, where myscript.sh is the name of the script. Ytmp appears to be an additional temporary file but must be present to prevent an error.

4. The results are available in folder results in a subfolder named as specified in "config.txt" (default: test)

The programs Yf m2vtu and m2vtu_crack contain an excessive amount of bugs, as detailed in the project documentation. This may be another reason as to why Travis is failing and errors are generated.

# Folder "Y2D"

## System requirements and Installation

- Operating System: Linux Ubuntu 18.04.2 LTS. The author used Windows subsystem for Linux Ubuntu 18.04 LTS https://docs.microsoft.com/en-us/Windows/wsl/install-win10 .

- Software:
>- OpenGL libaries libgl1-mesa-dev and libglu1-mesa-dev, installationable via 
    
>sudo apt-get install -y libgl1-mesa-dev libglu1-mesa-dev
    
## Usage

The folder contains two subfolders, "originalcode" and "finalcode". "originalcode" contains the initially provided code files. Excessive debugging is neccessary to even get the code running. This debugging is achieved in the other, completely separate subfolder finalcode. The subfolder also contains the algorithm to produce VTK output files.

As both subfolders have extremely similar structure, only the structure of the subfolder "finalcode" is explained. 

"finalcode" contains two folders, "test" and "Y2D".

Y2D, contains the code files of the Y2D FEMDEM code. "test" contains a bash script script.sh to produce the output files. The script is run via the command:

>bash script.sh
    
The script remakes the executables and runs the Yf program. The subfolder "results" contains the output vtu files. The files can be opened as a time series using paraview.






 


